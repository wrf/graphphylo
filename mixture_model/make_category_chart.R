# generate plots of CAT-fixed category mixture models

# raw data from iqtree
# http://www.iqtree.org/doc/Substitution-Models#protein-models

#  A   R   N   D   C   Q   E   G   H   I   L   K   M   F   P   S   T   W   Y   V
# Ala Arg Asn Asp Cys Gln Glu Gly His Ile Leu Lys Met Phe Pro Ser Thr Trp Tyr Val

# AAs in alphabetic order
aalist = c("A", "R", "N", "D", "C", "Q", "E", "G", "H", "I", "L", "K", "M", "F", "P", "S", "T", "W", "Y", "V")
# colors from sand to deep red
colset = c("#ffffb2", "#ffeda0", "#fecc5c", "#fd8d3c", "#f03b20", "#bd0026", "#dd1c77")

# data from https://www.sigmaaldrich.com/life-science/metabolomics/learning-center/amino-acid-reference-chart.html
# which itself derives from:
# Relationship of sidechain hydrophobicity and a‐helical propensity on the stability of the single‐stranded amphipathic a‐helix
# https://doi.org/10.1002/psc.310010507
hydrophobicity = c(41,-14,-28,-55,49,-10,-31,0,8,99,97,-23,74,100,-46,-5,13,96,63,76)
# sort and return index, which will reorder from hydrophilic (Asp) to most hydrophobic (Phe)
s_hyd = sort(hydrophobicity, index.return=TRUE)

#
# C10 Model
#

C10pi1 = c(0.4082573125,0.0081783015,0.0096285438,0.0069870889,0.0349388179,0.0075279735,0.0097846653,0.1221613215,0.0039151830,0.0125784287,0.0158338663,0.0059670150,0.0081313216,0.0061604332,0.0394155867,0.1682450664,0.0658132542,0.0018751587,0.0041579747,0.0604426865)
C10pi2 = c(0.1027763487,0.0418664491,0.0213272051,0.0155943616,0.0149663448,0.0440685478,0.0419667447,0.0138805792,0.0158864807,0.1066076641,0.1131944125,0.0436343681,0.0437800327,0.0180729309,0.0223250701,0.0529608087,0.1081741005,0.0045147205,0.0137373857,0.1606654446)
C10pi3 = c(0.0351766018,0.0019678632,0.0016591476,0.0006768741,0.0078706538,0.0016559557,0.0019686768,0.0022420602,0.0012878339,0.3515819591,0.1278183107,0.0018856550,0.0242631753,0.0126221329,0.0029771559,0.0049998099,0.0255378034,0.0011907778,0.0037539283,0.3888636245)
C10pi4 = c(0.0408513927,0.0269887074,0.2185648186,0.2333814790,0.0037602852,0.0380451418,0.0901238869,0.1158332065,0.0373197176,0.0025523644,0.0052164616,0.0485017266,0.0022571778,0.0025108218,0.0108333610,0.0804527209,0.0302879995,0.0010815260,0.0069890931,0.0044481118)
C10pi5 = c(0.0185492661,0.0062362395,0.0024895723,0.0009775062,0.0070416514,0.0083539447,0.0024891617,0.0028952913,0.0040103982,0.1632422345,0.4443079409,0.0043570878,0.1202815687,0.0733329781,0.0048827648,0.0051642443,0.0131806647,0.0068759784,0.0144734420,0.0968580644)
C10pi6 = c(0.1106750119,0.0352190043,0.0405186210,0.1636437899,0.0014834855,0.0877962201,0.2638456592,0.0325228293,0.0163803600,0.0068334902,0.0140679579,0.0677158208,0.0048988133,0.0023256777,0.0298982139,0.0562887953,0.0426922497,0.0010338979,0.0040522304,0.0181078719)
C10pi7 = c(0.0522657662,0.0668294648,0.0714836849,0.0297745257,0.0143324928,0.0736540298,0.0388386669,0.0228101108,0.1551638111,0.0187406149,0.0653779932,0.0439469345,0.0207189121,0.0624033021,0.0145475497,0.0549017631,0.0370140058,0.0193756900,0.1110694548,0.0267512268)
C10pi8 = c(0.0116587342,0.0050990142,0.0064011054,0.0021742457,0.0105340743,0.0040203734,0.0024251112,0.0034709143,0.0366787049,0.0187185330,0.0676489746,0.0026694717,0.0143534813,0.3650985596,0.0031159927,0.0094848536,0.0073713920,0.0509564551,0.3574858593,0.0206341497)
C10pi9 = c(0.0627195947,0.2038782162,0.0428629162,0.0236193294,0.0052662886,0.1098111767,0.0686284994,0.0256174957,0.0332612124,0.0128968249,0.0305627740,0.2270839355,0.0124036991,0.0039181841,0.0140440613,0.0483152469,0.0463378087,0.0025143473,0.0065521118,0.0197062770)
C10pi10 = c(0.1145518598,0.0324008908,0.0750614981,0.0416192189,0.0098549497,0.0339624663,0.0364907910,0.0503817581,0.0165233329,0.0092949460,0.0139153707,0.0423026886,0.0082240805,0.0046605982,0.0379221548,0.2610647896,0.1845829279,0.0017548981,0.0058538316,0.0195769483)

# combine columns
catlist = cbind(C10pi1,C10pi2,C10pi3,C10pi4,C10pi5,C10pi6,C10pi7,C10pi8,C10pi9,C10pi10)
ncat = ncol(catlist)

pdf(file="~/git/graphphylo/mixture_model/cat_c10_diagrams_raw.pdf", width=7, height=5)
par(mar=c(1,4.5,1,1))
plot(0,0,type='n',xlim=c(1,20), ylim=c(0,ncat), axes=FALSE, frame.plot=FALSE, xlab="", ylab="")
text(10,0,"CAT-C10 Model", cex=1.6)
mtext(rev(1:ncat), side=2, line=1, at=1:ncat, cex=1.4, las=1)
# iterate over each category, print letters where size and color are related to frequency
for (i in 1:ncat) {
	points(1:20, rep(ncat-i+1,20), pch=aalist, cex=(7+log(catlist[,i]))/2, col=colset[floor((7+log(catlist[,i]))/2)+2])
}
dev.off()

# get second measure for sorting, using the variance
varindex = sort(apply(catlist,2,var),index.return=TRUE)

pdf(file="~/git/graphphylo/mixture_model/cat_c10_diagrams_var.pdf", width=7, height=5)
par(mar=c(1,4.5,1,1))
plot(0,0,type='n',xlim=c(1,20), ylim=c(0,ncat), axes=FALSE, frame.plot=FALSE, xlab="", ylab="")
text(10,0,"CAT-C10 Model", cex=1.6)
mtext(rev(1:ncat), side=2, line=1, at=1:ncat, cex=1.4, las=1)
for (i in 1:ncat) {
	points(1:20, rep(ncat-i+1,20), pch=aalist[s_hyd$ix], cex=(7+log(catlist[,varindex$ix[i]][s_hyd$ix]))/2, col=colset[floor((7+log(catlist[,varindex$ix[i]][s_hyd$ix]))/2)+2])
}
dev.off()



#
# C20 Model
#

C20pi1 = c(0.0862412505,0.0171943793,0.0791293376,0.0329908619,0.0130504558,0.0169046938,0.0184526503,0.0366905299,0.0108013340,0.0097907148,0.0112826424,0.0220195221,0.0087821483,0.0044155335,0.0189273201,0.3178152357,0.2711700523,0.0015317305,0.0048342853,0.0179753220 )
C20pi2 = c(0.2035582865,0.0050980810,0.0077052407,0.0031656079,0.0348667285,0.0064044073,0.0070859400,0.0195235515,0.0024392035,0.1152573291,0.0789777393,0.0042380850,0.0309187017,0.0112429356,0.0164189221,0.0496777139,0.1118946615,0.0017762569,0.0048448213,0.2849057867 )
C20pi3 = c(0.0211547413,0.0014946177,0.0012755030,0.0005492865,0.0048188557,0.0012328812,0.0014539632,0.0011430874,0.0011346394,0.3928460626,0.1250644210,0.0013579946,0.0209788805,0.0128251737,0.0020247248,0.0026240726,0.0171914121,0.0011591071,0.0036027969,0.3860677787 )
C20pi4 = c(0.0376903543,0.2885196153,0.0365411474,0.0109469400,0.0064073829,0.0893564381,0.0358365464,0.0191106776,0.0329513951,0.0101711878,0.0237495504,0.2897626974,0.0096528870,0.0036349802,0.0105337370,0.0356313768,0.0355926500,0.0027925238,0.0066557222,0.0144621902 )
C20pi5 = c(0.0084597802,0.0053589922,0.0072525884,0.0024487852,0.0084909000,0.0042781483,0.0025055486,0.0024277107,0.0433214027,0.0097713028,0.0380507037,0.0026741007,0.0080724771,0.3420463838,0.0021418673,0.0080418935,0.0055322116,0.0494840193,0.4375001561,0.0121410277 )
C20pi6 = c(0.1759898886,0.0290429175,0.0332845569,0.1301263816,0.0017558693,0.0707183953,0.2182166681,0.0409535143,0.0130708195,0.0085622087,0.0159530702,0.0542946169,0.0054045759,0.0025276980,0.0371020404,0.0793480500,0.0540083424,0.0010592104,0.0036259116,0.0249552645 )
C20pi7 = c(0.1634397322,0.0195541184,0.0438701833,0.0374272612,0.0088659891,0.0137554758,0.0220611924,0.5296717726,0.0090006141,0.0017569353,0.0061156267,0.0167117975,0.0029390787,0.0030641349,0.0126457766,0.0829342776,0.0142835614,0.0028640685,0.0032398299,0.0057985736 )
C20pi8 = c(0.0917468761,0.0265853306,0.0290699087,0.0133818895,0.0284015012,0.0255084506,0.0196875685,0.0249898794,0.0449766405,0.0583555688,0.1155009222,0.0164915955,0.0395994595,0.0998479096,0.0209916159,0.0736482742,0.0661518462,0.0246463919,0.0972327226,0.0831856483 )
C20pi9 = c(0.0646700714,0.0988015996,0.0228907308,0.0168733856,0.0077117603,0.0996414875,0.0544977962,0.0148893975,0.0313851988,0.0505983315,0.1844282999,0.0907931290,0.0774839960,0.0219148172,0.0105004469,0.0321196170,0.0411766062,0.0084303030,0.0206106035,0.0505824221 )
C20pi10 = c(0.0135993865,0.0043408375,0.0018469375,0.0007951703,0.0100090240,0.0046420778,0.0018011758,0.0026794645,0.0072401918,0.0814026713,0.3661422246,0.0025158135,0.0734965132,0.2640965246,0.0038994134,0.0043668760,0.0075248451,0.0261564898,0.0660970801,0.0573472826 )
C20pi11 = c(0.1478036236,0.0842845089,0.0726630217,0.0534743238,0.0048825808,0.0757166156,0.0727246460,0.0907725939,0.0262288856,0.0035781075,0.0126777221,0.1051660098,0.0059621792,0.0029903868,0.0156558198,0.1459903343,0.0634877444,0.0015928454,0.0050760739,0.0092719768 )
C20pi12 = c(0.0186377412,0.0042055165,0.0019865236,0.0008329696,0.0054968852,0.0065890091,0.0020248504,0.0021713483,0.0023665991,0.2020809776,0.4370381920,0.0029120653,0.1241860384,0.0385383157,0.0040672279,0.0046177381,0.0149904396,0.0026871667,0.0056324117,0.1189379840 )
C20pi13 = c(0.0477624336,0.0505742667,0.0209574273,0.0141349161,0.0075791708,0.0429296799,0.0462688073,0.0052327914,0.0165351815,0.1741496627,0.1121253570,0.0577575020,0.0330288046,0.0130691347,0.0124374733,0.0264988925,0.0951754678,0.0031660482,0.0112465746,0.2093704079 )
C20pi14 = c(0.4164189845,0.0056100821,0.0091701381,0.0045131748,0.0406937949,0.0061320495,0.0063229801,0.0946185184,0.0031057404,0.0076443223,0.0099885414,0.0038941773,0.0069323155,0.0048438356,0.0187840756,0.2360774301,0.0746274607,0.0012172579,0.0034825786,0.0459225422 )
C20pi15 = c(0.0402295888,0.0735203003,0.1036647193,0.0365523994,0.0124782975,0.0826558132,0.0372197283,0.0233618081,0.2108307125,0.0093478727,0.0360561493,0.0482410586,0.0100289536,0.0459094917,0.0098503973,0.0533383445,0.0310209005,0.0140076639,0.1064377821,0.0152480184 )
C20pi16 = c(0.0323453034,0.0236282995,0.2520448083,0.2431495959,0.0035976296,0.0330831153,0.0710274499,0.1016074562,0.0366225082,0.0031410809,0.0051980542,0.0470129351,0.0024028744,0.0024429276,0.0094837826,0.0848355278,0.0359083275,0.0008730928,0.0067247672,0.0048704638 )
C20pi17 = c(0.1476256642,0.0334506604,0.0211972524,0.0403051550,0.0032327194,0.0371554480,0.0576893391,0.0330850942,0.0146392559,0.0108267008,0.0256200793,0.0451350877,0.0058651400,0.0047177179,0.3473710507,0.0892065279,0.0485899446,0.0016358749,0.0044177191,0.0282335685 )
C20pi18 = c(0.1031448143,0.0717747663,0.0435172139,0.0386401502,0.0061762467,0.0786603123,0.0923369140,0.0202338419,0.0246761899,0.0376904275,0.0376283678,0.0921698920,0.0161883318,0.0067666433,0.0128302120,0.0951450188,0.1378566702,0.0022144738,0.0083041573,0.0740453560 )
C20pi19 = c(0.0837542823,0.0899383244,0.0518811417,0.0804870571,0.0020735078,0.1456497470,0.1947759184,0.0229030361,0.0268458796,0.0074079756,0.0190249576,0.1459287407,0.0067395241,0.0023063393,0.0085616014,0.0455739585,0.0451080843,0.0010771349,0.0049325333,0.0150302559 )
C20pi20 = c(0.0578735570,0.0138313604,0.0491421636,0.2946738942,0.0011130839,0.0598250358,0.3402102668,0.0293911435,0.0139817004,0.0030525663,0.0062611922,0.0363365043,0.0027295976,0.0017034884,0.0156106390,0.0358044639,0.0249941878,0.0008664342,0.0038312977,0.0087674229 )

catlist = cbind(C20pi1,C20pi2,C20pi3,C20pi4,C20pi5,C20pi6,C20pi7,C20pi8,C20pi9,C20pi10,C20pi11,C20pi12,C20pi13,C20pi14,C20pi15,C20pi16,C20pi17,C20pi18,C20pi19,C20pi20)
ncat = ncol(catlist)
varindex = sort(apply(catlist,2,var),index.return=TRUE)
pdf(file="~/git/graphphylo/mixture_model/cat_c20_diagrams_var.pdf", width=7, height=8)
par(mar=c(1,4.5,1,1))
plot(0,0,type='n',xlim=c(1,20), ylim=c(0,ncat), axes=FALSE, frame.plot=FALSE, xlab="", ylab="", cex.lab=1.3)
text(10,0,"CAT-C20 Model", cex=1.6)
mtext(rev(1:ncat), side=2, line=1, at=1:ncat, cex=1.4, las=1)
for (i in 1:ncat) {
	points(1:20, rep(ncat-i+1,20), pch=aalist[s_hyd$ix], cex=(7+log(catlist[,varindex$ix[i]][s_hyd$ix]))/2, col=colset[floor((7+log(catlist[,varindex$ix[i]][s_hyd$ix]))/2)+2])
}
dev.off()


#
# C30 Model
#

C30pi1 = c(0.1100453954,0.0171294861,0.0640338464,0.1595411459,0.0019047235,0.0310187088,0.1098958823,0.0684301540,0.0137950707,0.0026283074,0.0073396531,0.0358553674,0.0024706414,0.0016629473,0.1669356820,0.1381790473,0.0568342547,0.0004661120,0.0035970152,0.0082365591)
C30pi2 = c(0.0874125465,0.0806320385,0.0382152368,0.0326119879,0.0049826376,0.0798168854,0.0951700809,0.0144042708,0.0210626652,0.0399884450,0.0301585074,0.1147200015,0.0126488911,0.0048996596,0.0137397028,0.0873769666,0.1558616621,0.0015122843,0.0053974463,0.0793880836)
C30pi3 = c(0.0225477414,0.0014900535,0.0013034594,0.0005959279,0.0050018158,0.0011436556,0.0015030529,0.0011570953,0.0009374322,0.3944689167,0.0889573138,0.0013600872,0.0189102669,0.0089216031,0.0018312028,0.0028336408,0.0189813395,0.0006693746,0.0023303726,0.4250556480)
C30pi4 = c(0.0602158209,0.0136833299,0.0414987935,0.2900084105,0.0009525462,0.0621611083,0.3610869026,0.0281925621,0.0130500799,0.0030516237,0.0060401889,0.0352704692,0.0027460635,0.0014625624,0.0127175499,0.0318109377,0.0225279521,0.0007948027,0.0034024563,0.0093258397)
C30pi5 = c(0.0101223637,0.0028344920,0.0012928910,0.0006379191,0.0085989355,0.0035028551,0.0011249625,0.0024085229,0.0047753376,0.0701153131,0.4135913903,0.0016748492,0.0744862631,0.2785384406,0.0040466582,0.0037087155,0.0052379329,0.0200222636,0.0523938808,0.0408860135)
C30pi6 = c(0.1335831781,0.0284789590,0.0213891629,0.1125775537,0.0010514541,0.0565844323,0.2099572968,0.0207551870,0.0121330488,0.0073526522,0.0133278240,0.0771772013,0.0030571689,0.0016793592,0.1890195131,0.0484054108,0.0373318180,0.0009266995,0.0026946425,0.0225174379)
C30pi7 = c(0.0408277374,0.0124491768,0.0080464869,0.0030634898,0.0153918410,0.0102922098,0.0066010880,0.0058113137,0.0245211764,0.1487514547,0.1637802160,0.0075923232,0.0385527359,0.1575049888,0.0058352224,0.0151578617,0.0332220362,0.0264937109,0.1213342989,0.1547706314)
C30pi8 = c(0.2469059247,0.0106278945,0.0168929681,0.0027418266,0.1039406309,0.0103988197,0.0054944756,0.0373263209,0.0085752319,0.0292403793,0.0535091180,0.0056123053,0.0302246485,0.0251775640,0.0078098946,0.1642352274,0.1239889705,0.0053155877,0.0163953993,0.0955868125)
C30pi9 = c(0.0549428629,0.1305426495,0.0202957532,0.0092915274,0.0099280995,0.0906036344,0.0417085054,0.0105563869,0.0363512470,0.0569584863,0.1681833183,0.1152521806,0.0592328363,0.0243860149,0.0083055411,0.0283778833,0.0412594019,0.0096355359,0.0249780472,0.0592100878)
C30pi10 = c(0.0462773303,0.0362984274,0.0412365193,0.0182504174,0.0172727117,0.0348990852,0.0224266258,0.0160971397,0.1357852215,0.0164966886,0.0598936127,0.0239396241,0.0164507129,0.1336320854,0.0117413009,0.0454156401,0.0304387749,0.0330338410,0.2350163763,0.0253978649)
C30pi11 = c(0.0474379955,0.0410179935,0.0222453982,0.0112116958,0.0082332447,0.0374051414,0.0388100853,0.0055998598,0.0149156570,0.1832173840,0.1100691114,0.0467850545,0.0356443791,0.0116643783,0.0100244663,0.0317171100,0.1114352326,0.0026685586,0.0099660086,0.2199312452)
C30pi12 = c(0.0213607696,0.0069976154,0.0039878996,0.0012941246,0.0061024858,0.0139566033,0.0036297282,0.0030017014,0.0038425894,0.1309465785,0.4566988203,0.0054567760,0.1947837355,0.0371808169,0.0040747282,0.0076991487,0.0198018718,0.0034086391,0.0064545692,0.0693207986)
C30pi13 = c(0.0919632044,0.0160004872,0.0764682386,0.0306717360,0.0117031014,0.0160060006,0.0171907654,0.0370684649,0.0100792697,0.0093123713,0.0097240970,0.0205385908,0.0075767282,0.0041589440,0.0179686194,0.3254471625,0.2744377258,0.0013887442,0.0044739725,0.0178217761)
C30pi14 = c(0.4649246103,0.0043013249,0.0075304815,0.0050731691,0.0233328752,0.0043571322,0.0057994247,0.1495242047,0.0023298425,0.0043361190,0.0055995530,0.0028525398,0.0039313170,0.0025588185,0.0186467246,0.2150194771,0.0477030158,0.0009038096,0.0020087184,0.0292668421)
C30pi15 = c(0.2051329382,0.0439661329,0.0339418395,0.1070980865,0.0020915940,0.0822742346,0.1989733497,0.0487574293,0.0127143076,0.0058124693,0.0133471767,0.0667787412,0.0043783406,0.0018235059,0.0110997761,0.0873961609,0.0519781961,0.0007361603,0.0023821404,0.0193174204)
C30pi16 = c(0.0263689890,0.0133613622,0.2727158135,0.3117715371,0.0039462429,0.0218978778,0.0694354212,0.0799842408,0.0309615130,0.0027521242,0.0038579661,0.0288630708,0.0018363656,0.0023351927,0.0062457560,0.0798729385,0.0324143174,0.0007229656,0.0063857732,0.0042705326)
C30pi17 = c(0.1526502637,0.0332784464,0.0168229991,0.0237392180,0.0040215287,0.0341733672,0.0377949108,0.0306214335,0.0141929803,0.0123317972,0.0290062362,0.0375543022,0.0064473224,0.0058584416,0.3864504800,0.0880336410,0.0489543188,0.0018252558,0.0048877798,0.0313552773)
C30pi18 = c(0.0080247558,0.0017408595,0.0006327403,0.0003385965,0.0023412143,0.0015507896,0.0007818945,0.0005403825,0.0010026402,0.3177056649,0.3737894172,0.0012598254,0.0488212345,0.0311968471,0.0020687549,0.0012095129,0.0065696791,0.0016309208,0.0043343553,0.1944599147)
C30pi19 = c(0.0599950319,0.1000540567,0.1334918892,0.0889730776,0.0016884984,0.0864856169,0.0962700957,0.0588796388,0.0327277145,0.0021467269,0.0070876372,0.1825860579,0.0033979446,0.0011800742,0.0141408084,0.0779002375,0.0448817374,0.0006249028,0.0032641120,0.0042241415)
C30pi20 = c(0.0393520657,0.0838170642,0.1425481600,0.0431197671,0.0099071945,0.1019786610,0.0394639510,0.0282866471,0.2095718357,0.0076101442,0.0258339558,0.0596434088,0.0084586675,0.0188680789,0.0096840517,0.0624998643,0.0347087967,0.0054645779,0.0564145251,0.0127685828)
C30pi21 = c(0.0072715487,0.0140998918,0.0019756795,0.0027603830,0.0067852535,0.0043339290,0.0025069369,0.0080834718,0.0113217919,0.0056609640,0.0394199644,0.0017735096,0.0079866080,0.1271475634,0.0041098092,0.0052244365,0.0043022271,0.6273570153,0.1084563767,0.0094226397)
C30pi22 = c(0.0907070068,0.0290062335,0.0860677696,0.0745872716,0.0063699858,0.0259377035,0.0386802115,0.4750046194,0.0168090013,0.0014721054,0.0055149849,0.0343855535,0.0024692074,0.0028859215,0.0112150781,0.0731110371,0.0153705714,0.0022914775,0.0041860660,0.0039281943)
C30pi23 = c(0.0055291882,0.0024626303,0.0046086594,0.0011413426,0.0072105915,0.0022692184,0.0009683043,0.0016070950,0.0325831191,0.0082918400,0.0353677882,0.0013849437,0.0074486804,0.3744093753,0.0013374573,0.0057402692,0.0037279636,0.0330334445,0.4609978298,0.0098802591)
C30pi24 = c(0.2443263138,0.0045386562,0.0062422652,0.0031590902,0.0273880205,0.0053593950,0.0076715636,0.0196089609,0.0020189401,0.1017435067,0.0468424225,0.0045492259,0.0201286022,0.0060619450,0.0185219126,0.0497753825,0.1170795523,0.0009577255,0.0035333687,0.3104931504)
C30pi25 = c(0.0863111274,0.0984811895,0.0313963115,0.0600902926,0.0024419845,0.1672351286,0.2036096150,0.0175221435,0.0245245046,0.0105994220,0.0271209781,0.1485789590,0.0095824358,0.0029393105,0.0068276769,0.0347800318,0.0408210979,0.0014001253,0.0055105388,0.0202271268)
C30pi26 = c(0.0643926114,0.0369048739,0.1031213278,0.1628208462,0.0023165895,0.0752534859,0.1762701353,0.0297139006,0.0303503732,0.0088163033,0.0148016812,0.0727140107,0.0056748403,0.0043066715,0.0099270322,0.0926433867,0.0833129915,0.0011237109,0.0093801464,0.0161550816)
C30pi27 = c(0.1736682858,0.0943628709,0.0520404980,0.0285984935,0.0083596568,0.0722446698,0.0483894060,0.0781901497,0.0266134684,0.0068641911,0.0219499324,0.0964011794,0.0112303313,0.0058273974,0.0169661076,0.1547802460,0.0751701930,0.0028774511,0.0082130397,0.0172524320)
C30pi28 = c(0.0347856579,0.3075984538,0.0314157384,0.0092355245,0.0062754891,0.0861073155,0.0323568406,0.0170288127,0.0306438905,0.0091932292,0.0224428556,0.3020845818,0.0093720833,0.0034303536,0.0104447169,0.0326882932,0.0328713449,0.0025244855,0.0064171317,0.0130832013)
C30pi29 = c(0.1087737102,0.0051781020,0.0032679768,0.0015823203,0.0247877480,0.0057932006,0.0041769888,0.0134703172,0.0024765788,0.1643462917,0.2337152707,0.0027000391,0.0539213396,0.0316523420,0.0154886946,0.0188187787,0.0474912345,0.0037656478,0.0073106362,0.2512827825)
C30pi30 = c(0.1101008748,0.0324324597,0.0435098681,0.0579268520,0.0072699765,0.0615196630,0.0828181488,0.0314463068,0.0308557019,0.0530865813,0.1096787834,0.0293860426,0.0458728977,0.0269153699,0.0296430687,0.0715887866,0.0685882454,0.0062324120,0.0257237601,0.0754042006)

catlist = cbind(C30pi1,C30pi2,C30pi3,C30pi4,C30pi5,C30pi6,C30pi7,C30pi8,C30pi9,C30pi10, C30pi11,C30pi12,C30pi13,C30pi14,C30pi15,C30pi16,C30pi17,C30pi18,C30pi19,C30pi20, C30pi21,C30pi22,C30pi23,C30pi24,C30pi25,C30pi26,C30pi27,C30pi28,C30pi29,C30pi30)

ncat = ncol(catlist)
varindex = sort(apply(catlist,2,var),index.return=TRUE)

pdf(file="~/git/graphphylo/mixture_model/cat_c30_diagrams_var.pdf", width=7, height=11)
par(mar=c(1,4.5,1,1))
plot(0,0,type='n',xlim=c(1,20), ylim=c(0,ncat), axes=FALSE, frame.plot=FALSE, xlab="", ylab="", cex.lab=1.3)
text(10,0,"CAT-C30 Model", cex=1.6)
mtext(rev(1:ncat), side=2, line=1, at=1:ncat, cex=1.4, las=1)
for (i in 1:ncat) {
	points(1:20, rep(ncat-i+1,20), pch=aalist[s_hyd$ix], cex=(7+log(catlist[,varindex$ix[i]][s_hyd$ix]))/2, col=colset[floor((7+log(catlist[,varindex$ix[i]][s_hyd$ix]))/2)+2])
}
dev.off()


#
# C40 Model
#

C40pi1 = c(0.0660259814,0.0231861755,0.1599815873,0.1054473175,0.0056586745,0.0273928499,0.0440360794,0.0711238664,0.0168194755,0.0039088727,0.0055316013,0.0366689617,0.0037412416,0.0013104807,0.0176359169,0.2497687201,0.1507079582,0.0006723214,0.0038290224,0.0065528958)
C40pi2 = c(0.0232377444,0.0122683027,0.2759650991,0.3532087982,0.0037987468,0.0197339134,0.0739378219,0.0576668030,0.0315866952,0.0031092806,0.0038711609,0.0259363304,0.0017355634,0.0024032103,0.0063116881,0.0657067704,0.0270483653,0.0007602894,0.0069602476,0.0047531689)
C40pi3 = c(0.0166486809,0.0012594763,0.0012622242,0.0005651446,0.0036665719,0.0010669784,0.0013356251,0.0008894749,0.0008231853,0.4129367561,0.0884689295,0.0011904105,0.0186054583,0.0082775676,0.0014029981,0.0021339439,0.0162167380,0.0006082049,0.0019553200,0.4206863114)
C40pi4 = c(0.2394741986,0.0072901253,0.0120536943,0.0044741726,0.0283811727,0.0086558850,0.0105529632,0.0135109628,0.0038929844,0.0765957115,0.0358494908,0.0071093014,0.0199496319,0.0055991131,0.0114265585,0.0847798773,0.1797284519,0.0009838000,0.0042240671,0.2454678377)
C40pi5 = c(0.1194613086,0.0233255669,0.0294552140,0.0134272792,0.0150526644,0.0301537796,0.0192173037,0.0337675998,0.0214746045,0.0579001821,0.1446308373,0.0147261337,0.0561242940,0.0550467421,0.0631355418,0.0925266727,0.0831230185,0.0131636136,0.0331118002,0.0811758434)
C40pi6 = c(0.0567043710,0.0117359330,0.0364734454,0.2955500969,0.0008924801,0.0609516515,0.3795154126,0.0230469606,0.0118360971,0.0031182036,0.0060137466,0.0314205689,0.0028584065,0.0012972333,0.0124745819,0.0300334889,0.0227051137,0.0007738758,0.0031343761,0.0094639563)
C40pi7 = c(0.0179027412,0.0040967133,0.0035697688,0.0008870412,0.0160760340,0.0045395474,0.0023182113,0.0039829808,0.0127292680,0.0404650518,0.1676143477,0.0027994718,0.0424172255,0.3344862590,0.0020115128,0.0075841581,0.0068227293,0.0518381385,0.2452542553,0.0326045442)
C40pi8 = c(0.2712170094,0.0056480837,0.0141045260,0.0021017036,0.2003830179,0.0048264059,0.0023229984,0.0502501222,0.0053727960,0.0150684657,0.0330003443,0.0020646283,0.0154811217,0.0202990358,0.0045351023,0.1764198412,0.0839578061,0.0046265242,0.0141271048,0.0741933626)
C40pi9 = c(0.0894736584,0.1040026384,0.0190192153,0.0272183085,0.0045538316,0.1168091917,0.1275076663,0.0115685734,0.0215746293,0.0469424171,0.0512035100,0.1382047308,0.0147656854,0.0056590176,0.0095546504,0.0383953611,0.0836652641,0.0017079427,0.0062181292,0.0819555787)
C40pi10 = c(0.0495441385,0.0375345822,0.0315863530,0.0143641284,0.0182505609,0.0316504100,0.0215379122,0.0140199913,0.1108543799,0.0247065801,0.0700287927,0.0258142032,0.0188271760,0.1418048822,0.0112101202,0.0456094427,0.0361427973,0.0371985427,0.2223972375,0.0369177689)
C40pi11 = c(0.1704314254,0.0415784004,0.0271109259,0.1098556600,0.0009747331,0.0917299929,0.2536458944,0.0249846466,0.0101389736,0.0058749399,0.0116526350,0.0903324267,0.0036512738,0.0013321301,0.0293613681,0.0561765645,0.0479045729,0.0006696817,0.0022637316,0.0203300232)
C40pi12 = c(0.0162725399,0.0054826071,0.0021876158,0.0010182101,0.0050614097,0.0104414465,0.0025141347,0.0021935389,0.0029914328,0.1328173512,0.4904441779,0.0040120394,0.1929931280,0.0376245580,0.0034333187,0.0040122105,0.0127074428,0.0032107554,0.0058100621,0.0647720205)
C40pi13 = c(0.0823765743,0.0734226431,0.0598389731,0.0311745159,0.0065694304,0.0686451074,0.0675530778,0.0178961594,0.0251143622,0.0291161743,0.0287904106,0.0982301674,0.0168022878,0.0064717899,0.0114044922,0.1302995288,0.1820374273,0.0022724618,0.0079573279,0.0540270885)
C40pi14 = c(0.3594965940,0.0072407229,0.0033421456,0.0031484357,0.0251417178,0.0049014279,0.0064962700,0.1194682267,0.0022970448,0.0458766662,0.0468053893,0.0050168849,0.0215568816,0.0092020461,0.0443915884,0.0465270945,0.0477755293,0.0024540215,0.0046450361,0.1942162766)
C40pi15 = c(0.2015583874,0.0430161610,0.0425386444,0.0954149893,0.0032365302,0.0772010857,0.1534908791,0.0667291678,0.0155218808,0.0067740832,0.0165114429,0.0547322644,0.0060162992,0.0025643300,0.0091970560,0.1185981804,0.0625472744,0.0009565508,0.0031150007,0.0202797924)
C40pi16 = c(0.1042731047,0.0147062345,0.0621645800,0.2424069523,0.0022450116,0.0356498946,0.1774821588,0.1697819523,0.0132648834,0.0018929517,0.0042542620,0.0220651981,0.0016441234,0.0012570256,0.0317041583,0.0778636230,0.0288515782,0.0006930898,0.0017741945,0.0060250231)
C40pi17 = c(0.0781183281,0.0111498472,0.0159270309,0.0041541669,0.0194448667,0.0240151620,0.0116633921,0.0111524105,0.0063589385,0.1354530457,0.2457574952,0.0093729846,0.1087781166,0.0262793949,0.0055294038,0.0408518858,0.0860514305,0.0031547586,0.0085108496,0.1482764918)
C40pi18 = c(0.0856592432,0.0101233167,0.0441923073,0.0135061568,0.0136072878,0.0092590642,0.0078602552,0.0245400880,0.0055379075,0.0100591561,0.0103343559,0.0127318506,0.0080675803,0.0047153035,0.0175273997,0.3406479487,0.3573294650,0.0014243098,0.0035099810,0.0193670227)
C40pi19 = c(0.0674594695,0.1161734658,0.1163107783,0.0662588409,0.0021634231,0.0939360452,0.0865501280,0.0368556575,0.0381149118,0.0033238825,0.0093839985,0.1899736999,0.0039487389,0.0018212730,0.0151207830,0.0842204423,0.0565953680,0.0007187305,0.0046189437,0.0064514195)
C40pi20 = c(0.0572262322,0.0494723554,0.1083882793,0.1793932771,0.0015301521,0.0903668522,0.1992261265,0.0316472274,0.0291392067,0.0045804559,0.0100739563,0.1015624916,0.0040204606,0.0013701849,0.0063674130,0.0621142922,0.0496102162,0.0006669285,0.0046497641,0.0085941279)
C40pi21 = c(0.0036020163,0.0102712927,0.0013455508,0.0020871647,0.0045484804,0.0032718114,0.0017857730,0.0056391633,0.0064968790,0.0029292916,0.0232635081,0.0010419846,0.0044592278,0.0855714596,0.0024991984,0.0030671803,0.0025900250,0.7617821954,0.0678809532,0.0058668443)
C40pi22 = c(0.2032018418,0.0083895722,0.0143743754,0.0135011707,0.0098131618,0.0044514580,0.0083818173,0.6184886075,0.0027747899,0.0011828492,0.0039826789,0.0044598895,0.0020631785,0.0019619615,0.0085870399,0.0739919851,0.0108922273,0.0018606145,0.0015638674,0.0060769136)
C40pi23 = c(0.0050898779,0.0028740788,0.0057092962,0.0016126151,0.0061776450,0.0024693148,0.0012040415,0.0016334183,0.0393460780,0.0059088776,0.0249343597,0.0013713662,0.0049795162,0.3563126947,0.0014136424,0.0059527667,0.0036536770,0.0357987380,0.4853645852,0.0081934106)
C40pi24 = c(0.0403335679,0.0540186397,0.0216052457,0.0098218598,0.0081549541,0.0383639077,0.0375406578,0.0047934404,0.0176735565,0.1893424159,0.1051859862,0.0607377395,0.0305599836,0.0119140782,0.0077550551,0.0257110173,0.1009913165,0.0028780020,0.0115276935,0.2210908828)
C40pi25 = c(0.0790086293,0.1065441152,0.0309384274,0.0546012394,0.0024947877,0.1843375981,0.1997882784,0.0192655847,0.0270700474,0.0075667489,0.0254542392,0.1553108816,0.0098024439,0.0023773444,0.0056640684,0.0332370813,0.0359574739,0.0011682801,0.0048820809,0.0145306498)
C40pi26 = c(0.0722240672,0.0489728405,0.0678929607,0.1194883992,0.0064755348,0.0708969573,0.1345886574,0.0287815397,0.0699011334,0.0173588702,0.0519870084,0.0490341790,0.0154411043,0.0348233029,0.0145597486,0.0589579876,0.0425972780,0.0087913770,0.0554386705,0.0317883834)
C40pi27 = c(0.1085842431,0.0206450023,0.0441956285,0.1529666596,0.0012502570,0.0405398136,0.1664851192,0.0336098469,0.0134902179,0.0038821795,0.0089861440,0.0576227094,0.0024339036,0.0014553522,0.1990095021,0.0846749753,0.0454715217,0.0005902831,0.0027650162,0.0113416246)
C40pi28 = c(0.0309526387,0.3195887318,0.0301336637,0.0082352132,0.0065593963,0.0832608108,0.0291974083,0.0154206187,0.0310385092,0.0098251607,0.0237900204,0.3062634996,0.0097071728,0.0036891639,0.0095029109,0.0295285439,0.0303052301,0.0028125285,0.0068850639,0.0133037148)
C40pi29 = c(0.0098953741,0.0019604525,0.0007307935,0.0003748228,0.0028276741,0.0017337004,0.0009182100,0.0006997068,0.0010419482,0.3115040359,0.3750387796,0.0013960508,0.0474451070,0.0298607430,0.0025296256,0.0014628019,0.0075738968,0.0016799771,0.0040259930,0.1973003069)
C40pi30 = c(0.1163213921,0.0273321006,0.0250163656,0.0731917718,0.0034792282,0.0586677248,0.1380880502,0.0193193469,0.0160240740,0.0712243431,0.0771473538,0.0355120487,0.0242841072,0.0094117688,0.0508926833,0.0475560280,0.0726552233,0.0026892716,0.0076166020,0.1235705162)
C40pi31 = c(0.1285218235,0.0373073487,0.1179844215,0.0402749992,0.0172928883,0.0439706110,0.0250692272,0.1127033137,0.0606981059,0.0109350265,0.0258415767,0.0288749652,0.0167592956,0.0199118302,0.0180674983,0.1741489481,0.0648967655,0.0063574951,0.0321771650,0.0182066946)
C40pi32 = c(0.0372286941,0.0094528028,0.0053377315,0.0023703173,0.0144940088,0.0079097138,0.0048585146,0.0046433943,0.0186795102,0.1820459527,0.1780099317,0.0058198481,0.0371334296,0.1463772419,0.0048538601,0.0103570678,0.0284161577,0.0211293603,0.0958905187,0.1849919442)
C40pi33 = c(0.0535643726,0.1159797757,0.0239172676,0.0113537364,0.0096256227,0.0928585070,0.0391699080,0.0120279334,0.0384887950,0.0522748270,0.1892392595,0.0996037748,0.0712219098,0.0264213736,0.0083720574,0.0299114019,0.0389484845,0.0104232046,0.0265030050,0.0500947835)
C40pi34 = c(0.1332424803,0.0033147683,0.0022704992,0.0012739239,0.0246514263,0.0030843469,0.0040461524,0.0089139209,0.0015864680,0.1971284995,0.1251288442,0.0023713225,0.0286947200,0.0156995251,0.0118845743,0.0171461828,0.0563298009,0.0017341820,0.0048778410,0.3566205216)
C40pi35 = c(0.1498658185,0.0326607222,0.0176452820,0.0280354786,0.0035437399,0.0348151308,0.0435380704,0.0311112643,0.0140625707,0.0101953314,0.0251433928,0.0393124980,0.0051548319,0.0047533945,0.3923800449,0.0874496981,0.0473306717,0.0015215239,0.0043208299,0.0271597054)
C40pi36 = c(0.4214366359,0.0061425967,0.0121590498,0.0073305074,0.0187609694,0.0072748556,0.0086837775,0.0902333103,0.0030262044,0.0039362777,0.0047193320,0.0051508681,0.0038306586,0.0027156136,0.0208940236,0.2901188793,0.0651922314,0.0008108235,0.0023622848,0.0252211004)
C40pi37 = c(0.1770713890,0.1332782050,0.0311656783,0.0226500225,0.0078348946,0.0752471493,0.0509767242,0.0897389513,0.0220667143,0.0059519850,0.0205369728,0.1257689326,0.0092982479,0.0040514178,0.0264087912,0.1169591448,0.0565566955,0.0029947127,0.0049346701,0.0165087010)
C40pi38 = c(0.0293984032,0.0370901720,0.1483622633,0.1099709900,0.0031729093,0.0388688450,0.0464270335,0.4222420155,0.0272494642,0.0007997326,0.0037634298,0.0622314461,0.0016657052,0.0015039626,0.0056481827,0.0472252404,0.0086568982,0.0009176022,0.0027693124,0.0020363920)
C40pi39 = c(0.0265779317,0.0791104753,0.1318603134,0.0280314140,0.0101369144,0.0989710810,0.0269057233,0.0173376629,0.2815133703,0.0064646977,0.0268210053,0.0474749135,0.0072375268,0.0276960902,0.0083014995,0.0426276702,0.0259042511,0.0078528946,0.0891598394,0.0100147256)
C40pi40 = c(0.0096096503,0.0027136180,0.0013104432,0.0006331856,0.0077301682,0.0033899420,0.0010471898,0.0020227436,0.0039001415,0.0733098005,0.4451691588,0.0014931484,0.0732575295,0.2630171690,0.0042768091,0.0036117358,0.0057928403,0.0181275729,0.0370698053,0.0425173480)

catlist = cbind(C40pi1,C40pi3,C40pi3,C40pi4,C40pi5,C40pi6,C40pi7,C40pi8,C40pi9,C40pi10, C40pi11,C40pi12,C40pi13,C40pi14,C40pi15,C40pi16,C40pi17,C40pi18,C40pi19,C40pi20, C40pi21,C40pi22,C40pi23,C40pi24,C40pi25,C40pi26,C40pi27,C40pi28,C40pi29,C40pi30, C40pi31,C40pi32,C40pi33,C40pi34,C40pi35,C40pi36,C40pi37,C40pi38,C40pi39,C40pi40)

ncat = ncol(catlist)
varindex = sort(apply(catlist,2,var),index.return=TRUE)

pdf(file="~/git/graphphylo/mixture_model/cat_c40_diagrams_var.pdf", width=7, height=14)
par(mar=c(1,4.5,1,1))
plot(0,0,type='n',xlim=c(1,20), ylim=c(0,ncat), axes=FALSE, frame.plot=FALSE, xlab="", ylab="", cex.lab=1.3)
text(10,0,"CAT-C40 Model", cex=1.6)
mtext(rev(1:ncat), side=2, line=1, at=1:ncat, cex=1.4, las=1)
for (i in 1:ncat) {
	points(1:20, rep(ncat-i+1,20), pch=aalist[s_hyd$ix], cex=(7+log(catlist[,varindex$ix[i]][s_hyd$ix]))/2, col=colset[floor((7+log(catlist[,varindex$ix[i]][s_hyd$ix]))/2)+2])
}
dev.off()







#